---
title: 'Sentry en React Native CLI: Gu√≠a Completa de Integraci√≥n'
date: '2025-11-20'
summary: 'Aprende a configurar Sentry en React Native CLI para capturar errores, source maps y tracking de navegaci√≥n. Incluye troubleshooting y optimizaci√≥n del plan gratuito.'
tags: ['React Native', 'Sentry', 'Error Tracking', 'Debugging', 'Source Maps']
---

Sentry es una plataforma esencial para el monitoreo de errores en aplicaciones m√≥viles. En esta gu√≠a completa, aprender√°s a configurar Sentry en React Native CLI, subir source maps, trackear navegaci√≥n y optimizar el uso del plan gratuito.

```
üì± Tu App React Native
    ‚îÇ
    ‚îÇ Ocurre un error ‚ùå
    ‚îÇ
    ‚ñº
üîç Sentry Dashboard muestra:
    ‚úì Stack trace completo
    ‚úì Pantalla donde crashe√≥
    ‚úì Screenshot del error
    ‚úì Datos del usuario
    ‚úì Historial de navegaci√≥n
```

## ¬øPor qu√© usar Sentry en React Native?

Cuando tu app est√° en producci√≥n, los errores son inevitables. Sentry te permite:

- üêõ **Capturar errores autom√°ticamente** - JavaScript y crashes nativos
- üó∫Ô∏è **Ver c√≥digo fuente original** - Gracias a los source maps
- üì± **Saber en qu√© pantalla crashe√≥** - Con integraci√≥n de React Navigation
- üìä **Analizar performance** - Tiempo de carga de pantallas
- üì∏ **Capturar screenshots** - Del momento exacto del crash

## Instalaci√≥n

```bash
# Instalar Sentry
yarn add @sentry/react-native

# Ejecutar el wizard (configura autom√°ticamente)
npx @sentry/wizard@latest -i reactNative
```

El wizard configura autom√°ticamente:
- ‚úÖ `App.jsx` con `Sentry.init()`
- ‚úÖ `android/app/build.gradle` con el plugin de Sentry
- ‚úÖ `ios/` con scripts de Xcode
- ‚úÖ Crea archivos `sentry.properties`

## Configuraci√≥n B√°sica

### 1. Inicializaci√≥n en App.jsx

```javascript
import * as Sentry from '@sentry/react-native';

Sentry.init({
  dsn: 'TU_DSN_DE_SENTRY',
  environment: __DEV__ ? 'development' : 'production',
  enableAutoSessionTracking: true,
  enableNativeCrashHandling: true,
  attachScreenshot: true, // Captura screenshots en crashes
  tracesSampleRate: __DEV__ ? 1.0 : 0.2, // 100% en dev, 20% en prod
  profilesSampleRate: __DEV__ ? 1.0 : 0.1,
});

export default __DEV__ ? App : Sentry.wrap(App);
```

**Importante:**
- En desarrollo usa `1.0` (100%) para ver todo
- En producci√≥n reduce a `0.1-0.2` para ahorrar cuota del plan gratuito

## Source Maps: El Coraz√≥n de Sentry

```
SIN SOURCE MAPS ‚ùå
Error at index.android.bundle:1:8234
(¬øQu√© archivo? ¬øQu√© l√≠nea? Imposible saber)

CON SOURCE MAPS ‚úÖ
Error at src/screens/HomeScreen.js:42
(¬°Archivo y l√≠nea exactos!)
```

### ¬øQu√© son los Source Maps?

Imagina que tu c√≥digo React Native:

```javascript
// Tu c√≥digo original (src/screens/HomeScreen.js:42)
function handlePress() {
  const user = getUserData();
  if (!user) {
    throw new Error("User not found");
  }
}
```

Se convierte en producci√≥n en:

```javascript
// Minificado (index.android.bundle:1:8234)
function a(){const b=c();if(!b)throw new Error("User not found")}
```

**Sin source maps**, Sentry te muestra:
```
Error: User not found
  at a (index.android.bundle:1:8234)  ‚Üê ¬øQu√© es esto?
```

**Con source maps**, Sentry te muestra:
```
Error: User not found
  at handlePress (src/screens/HomeScreen.js:42:5)  ‚Üê ¬°Perfecto!
```

### Configuraci√≥n Autom√°tica de Source Maps

En `metro.config.js`:

```javascript
const { getDefaultConfig, mergeConfig } = require('@react-native/metro-config');
const { withSentryConfig } = require('@sentry/react-native/metro');

const config = {};

module.exports = withSentryConfig(mergeConfig(getDefaultConfig(__dirname), config));
```

En `android/app/build.gradle`:

```gradle
apply from: new File(["node", "--print", "require.resolve('@sentry/react-native/package.json')"].execute().text.trim(), "../sentry.gradle")

sentry {
    uploadNativeSymbols = true
    includeNativeSources = true
}
```

### Subida Manual de Source Maps

Si la subida autom√°tica falla, usa `sentry-cli`:

```bash
# 1. Login en Sentry CLI
sentry-cli login

# 2. Crear release
sentry-cli releases new 1.0.0-2 --org tu-org --project tu-proyecto

# 3. Subir source maps
sentry-cli sourcemaps upload \
  --org tu-org \
  --project tu-proyecto \
  --release 1.0.0-2 \
  --dist 2 \
  android/app/build/generated/sourcemaps/react/release/

# 4. Finalizar release
sentry-cli releases finalize 1.0.0-2 --org tu-org --project tu-proyecto
```

**Tip:** El `--dist` debe coincidir con el `versionCode` en `build.gradle`.

## Tracking de Navegaci√≥n

```
Navegaci√≥n del usuario:
Login ‚Üí Home ‚Üí Checkout ‚ùå

Sentry te muestra:
üìç Pantalla actual: "CheckoutScreen"
üìç Pantalla anterior: "HomeScreen"
üçû Historial completo de navegaci√≥n
```

Para que Sentry te diga **en qu√© pantalla** ocurri√≥ el error, integra React Navigation:

### En App.jsx:

```javascript
import * as Sentry from '@sentry/react-native';

// Integraci√≥n oficial con React Navigation
export const navigationIntegration = Sentry.reactNavigationIntegration({
  enableTimeToInitialDisplay: true, // Mide performance de pantallas
});

Sentry.init({
  dsn: 'TU_DSN',
  integrations: [navigationIntegration],
  // ... resto de config
});
```

### En tu NavigationContainer:

```javascript
import { NavigationContainer, createNavigationContainerRef } from '@react-navigation/native';
import { navigationIntegration } from '../App';

export const navigationRef = createNavigationContainerRef();

function AppNavigator() {
  return (
    <NavigationContainer
      ref={navigationRef}
      onReady={() => {
        navigationIntegration.registerNavigationContainer(navigationRef);
      }}
    >
      {/* Tu navegaci√≥n */}
    </NavigationContainer>
  );
}
```

Ahora en Sentry ver√°s:

```
CONTEXTS:
  navigation:
    current_screen: "LoginScreen"  ‚Üê ¬°Aqu√≠ crashe√≥!
    params: { userId: 123 }
```

## Probar la Integraci√≥n

Agrega un bot√≥n temporal para forzar un crash:

```javascript
import { TouchableOpacity, Text } from 'react-native';

// TEMPORAL - Eliminar despu√©s
<TouchableOpacity
  onPress={() => {
    throw new Error('üî• Test crash - Sentry integration');
  }}
  style={{ padding: 15, backgroundColor: '#FF4444', borderRadius: 8 }}
>
  <Text style={{ color: 'white' }}>Test Sentry Crash</Text>
</TouchableOpacity>
```

Presiona el bot√≥n y ve a tu dashboard de Sentry. Deber√≠as ver:
- ‚úÖ El error con el mensaje
- ‚úÖ El nombre del archivo y l√≠nea exacta
- ‚úÖ La pantalla donde ocurri√≥
- ‚úÖ Screenshot del momento del crash

## Optimizaci√≥n del Plan Gratuito

El plan gratuito de Sentry incluye:

- **5,000 eventos de error/mes** - Suficiente para apps peque√±as/medianas
- **10,000 transacciones de performance/mes**
- **Screenshots incluidos** - No consumen cuota extra
- **1 GB de attachments**

### Estrategias de Optimizaci√≥n

#### 1. Sample Rate Diferenciado

```javascript
Sentry.init({
  // Errores siempre se capturan al 100% (no afectado por estos valores)
  tracesSampleRate: __DEV__ ? 1.0 : 0.2, // Solo 20% de transacciones en prod
  profilesSampleRate: __DEV__ ? 1.0 : 0.1, // Solo 10% de profiles en prod
});
```

#### 2. Filtrar Errores No Cr√≠ticos

```javascript
Sentry.init({
  beforeSend(event, hint) {
    // Ignorar errores de red temporales
    if (event.exception?.values?.[0]?.value?.includes('Network request failed')) {
      return null; // No enviar a Sentry
    }
    return event;
  },
});
```

#### 3. Usar Environments

```javascript
Sentry.init({
  environment: __DEV__ ? 'development' : 'production',
  // En dashboard, filtra solo 'production' para ahorrar cuota
});
```

## Errores Comunes y Soluciones

### 1. "Processing source maps" pero no se suben

**Problema:** El build muestra "Processing" pero los source maps no aparecen en Sentry.

**Soluci√≥n:** Verifica que exista `android/sentry.properties` con tu auth token:

```properties
auth.token=TU_TOKEN_DE_SENTRY
defaults.org=tu-organizacion
defaults.project=tu-proyecto
defaults.url=https://sentry.io/
```

### 2. Crash en TextInput (NullPointerException)

**Problema:** Bug conocido de Android 14 con Samsung + `KeyboardAwareScrollView`.

**Soluci√≥n:** Agrega estas props:

```javascript
<KeyboardAwareScrollView
  enableResetScrollToCoords={false}  // Previene el crash
  keyboardShouldPersistTaps="handled"
>
```

### 3. No aparece el nombre de la pantalla

**Problema:** Sentry no muestra en qu√© pantalla ocurri√≥ el error.

**Soluci√≥n:** Aseg√∫rate de haber configurado `navigationIntegration` como se mostr√≥ arriba.

## Versionado para Producci√≥n

Cuando publiques en Google Play Store:

```gradle
// android/app/build.gradle
android {
    defaultConfig {
        versionCode 4         // Incrementa esto cada vez
        versionName "1.0.1"   // Versi√≥n visible para usuarios
    }
}
```

Y sube los source maps correspondientes:

```bash
sentry-cli releases new 1.0.1-4 --org tu-org --project tu-proyecto
# ... subir source maps ...
```

## Comandos √ötiles de sentry-cli

```bash
# Ver releases
sentry-cli releases list --org tu-org --project tu-proyecto

# Ver info de un release
sentry-cli releases info 1.0.0-2 --org tu-org --project tu-proyecto

# Validar autenticaci√≥n
sentry-cli login --validate

# Ver configuraci√≥n actual
sentry-cli info

# Enviar evento de prueba
sentry-cli send-event -m "Test error" --release 1.0.0-2
```

## Mejores Pr√°cticas

### 1. Contexto de Usuario

Agrega informaci√≥n del usuario para facilitar el debugging:

```javascript
Sentry.setUser({
  id: user.id,
  email: user.email,
  username: user.username,
});

// Limpiar al hacer logout
Sentry.setUser(null);
```

### 2. Tags Personalizados

```javascript
Sentry.setTag('payment_method', 'credit_card');
Sentry.setTag('user_type', 'premium');
```

### 3. Breadcrumbs Personalizados

```javascript
Sentry.addBreadcrumb({
  category: 'payment',
  message: 'User initiated payment',
  level: 'info',
  data: { amount: 100, currency: 'USD' },
});
```

### 4. Capturar Excepciones Manejadas

```javascript
try {
  await processPayment();
} catch (error) {
  Sentry.captureException(error, {
    tags: { payment_step: 'processing' },
    contexts: { payment: { amount: 100 } },
  });
  // Mostrar mensaje al usuario
}
```

## Tipos de Errores que Sentry Captura

### 1. Errores de JavaScript

```javascript
throw new Error('Something went wrong');
// Sentry lo captura autom√°ticamente
```

### 2. Crashes Nativos (Android/iOS)

```
NullPointerException (Android)
Fatal Exception: NSInvalidArgumentException (iOS)
```

### 3. Errores de Librer√≠as Externas

```
Error in react-native-maps
Error in @react-navigation/native
```

Sentry captura TODO, y en el stack trace ver√°s:
- L√≠neas de **tu c√≥digo**: `src/screens/HomeScreen.js:42`
- L√≠neas de **librer√≠as**: `node_modules/react-native/...`

## Monitoreo en Producci√≥n

Una vez en producci√≥n, revisa regularmente:

1. **Dashboard de Issues** - Nuevos errores
2. **Release Health** - Crash-free rate por versi√≥n
3. **Performance** - Transacciones lentas
4. **Alerts** - Configura notificaciones por Slack/Email

## Conclusi√≥n

Sentry es una herramienta esencial para cualquier app React Native en producci√≥n. Con esta configuraci√≥n:

- ‚úÖ Capturas todos los errores (JS y nativos)
- ‚úÖ Ves c√≥digo fuente original (gracias a source maps)
- ‚úÖ Sabes en qu√© pantalla crashea la app
- ‚úÖ Tienes screenshots del momento del error
- ‚úÖ Optimizas el plan gratuito para no pasarte de cuota

**Siguientes pasos:**
1. Integra Sentry en tu proyecto
2. Configura source maps
3. Prueba con un crash intencional
4. Configura alertas para tu equipo
5. ¬°Duerme tranquilo sabiendo que Sentry vigila tu app! üò¥

## Recursos Adicionales

- [Documentaci√≥n oficial de Sentry](https://docs.sentry.io/platforms/react-native/)
- [React Navigation Integration](https://docs.sentry.io/platforms/react-native/tracing/instrumentation/react-navigation/)
- [Sentry CLI Reference](https://docs.sentry.io/cli/)
- [Source Maps Troubleshooting](https://docs.sentry.io/platforms/react-native/sourcemaps/)

---

¬øTe result√≥ √∫til esta gu√≠a? ¬°Comp√°rtela con otros desarrolladores React Native! üöÄ
